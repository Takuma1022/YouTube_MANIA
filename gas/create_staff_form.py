#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•å‚åŠ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ â”€â”€ Google ãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
Google Forms API v1 ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆï¼ˆå…¨21å•ãƒ»5ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰

ä½¿ã„æ–¹:
  1. ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:
     pip install google-api-python-client google-auth-httplib2 google-auth-oauthlib
  2. å®Ÿè¡Œ:
     $env:PYTHONIOENCODING="utf-8"; python create_staff_form.py
"""

import os
import sys
import pickle
import webbrowser
from pathlib import Path
from google.oauth2.credentials import Credentials
from google_auth_oauthlib.flow import InstalledAppFlow
from google.auth.transport.requests import Request
from googleapiclient.discovery import build
from googleapiclient.errors import HttpError

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# è¨­å®š
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCOPES = [
    'https://www.googleapis.com/auth/forms.body',
    'https://www.googleapis.com/auth/drive.file',
    'https://www.googleapis.com/auth/drive'
]

# èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ï¼ˆCursor Drive ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰å–å¾—ï¼‰
TEMPLATE_DIR = r"G:\ãƒã‚¤ãƒ‰ãƒ©ã‚¤ãƒ–\Cursor Drive\AIãƒ„ãƒ¼ãƒ«\Googleãƒ•ã‚©ãƒ¼ãƒ ä½œæˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ"
CREDENTIALS_FILE = os.path.join(
    TEMPLATE_DIR,
    'client_secret_907845363340-dp7e8arcfhbhf9bpb6but235gjtldlbf.apps.googleusercontent.com.json'
)
TOKEN_FILE = os.path.join(TEMPLATE_DIR, 'token.pickle')

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ï¼ˆJSON å®šç¾©ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FORM_TITLE = "æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•å‚åŠ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ"
FORM_DESCRIPTION = (
    "æ–°ã—ãå‚åŠ ã—ã¦ãã ã•ã£ãŸã‚¹ã‚¿ãƒƒãƒ•å‘ã‘ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã§ã™ã€‚"
    "æ´»å‹•çŠ¶æ³ã‚„ã‚¹ã‚­ãƒ«ã‚»ãƒƒãƒˆã«ã¤ã„ã¦ã”å›ç­”ãã ã•ã„ã€‚"
)

SECTIONS = [
    {
        "header": "åŸºæœ¬æƒ…å ±ãƒ»å±æ€§",
        "items": [
            {
                "id": 1,
                "title": "ãŠåå‰ï¼ˆæœ¬åï¼‰",
                "type": "TEXT",
                "required": True,
            },
            {
                "id": 2,
                "title": "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆGmailï¼‰",
                "type": "TEXT",
                "validation": "EMAIL",
                "helpText": "Google Workspace ã‚„å…±æœ‰æ¨©é™ã®éƒ½åˆä¸Šã€Gmail ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã”è¨˜å…¥ãã ã•ã„ã€‚",
                "required": True,
            },
            {
                "id": 3,
                "title": "ãŠä½ã¾ã„ã®åœ°åŸŸï¼ˆéƒ½é“åºœçœŒï¼‰",
                "type": "DROPDOWN",
                "options": [
                    "åŒ—æµ·é“", "é’æ£®çœŒ", "å²©æ‰‹çœŒ", "å®®åŸçœŒ", "ç§‹ç”°çœŒ",
                    "å±±å½¢çœŒ", "ç¦å³¶çœŒ", "èŒ¨åŸçœŒ", "æ ƒæœ¨çœŒ", "ç¾¤é¦¬çœŒ",
                    "åŸ¼ç‰çœŒ", "åƒè‘‰çœŒ", "æ±äº¬éƒ½", "ç¥å¥ˆå·çœŒ", "æ–°æ½ŸçœŒ",
                    "å¯Œå±±çœŒ", "çŸ³å·çœŒ", "ç¦äº•çœŒ", "å±±æ¢¨çœŒ", "é•·é‡çœŒ",
                    "å²é˜œçœŒ", "é™å²¡çœŒ", "æ„›çŸ¥çœŒ", "ä¸‰é‡çœŒ", "æ»‹è³€çœŒ",
                    "äº¬éƒ½åºœ", "å¤§é˜ªåºœ", "å…µåº«çœŒ", "å¥ˆè‰¯çœŒ", "å’Œæ­Œå±±çœŒ",
                    "é³¥å–çœŒ", "å³¶æ ¹çœŒ", "å²¡å±±çœŒ", "åºƒå³¶çœŒ", "å±±å£çœŒ",
                    "å¾³å³¶çœŒ", "é¦™å·çœŒ", "æ„›åª›çœŒ", "é«˜çŸ¥çœŒ", "ç¦å²¡çœŒ",
                    "ä½è³€çœŒ", "é•·å´çœŒ", "ç†Šæœ¬çœŒ", "å¤§åˆ†çœŒ", "å®®å´çœŒ",
                    "é¹¿å…å³¶çœŒ", "æ²–ç¸„çœŒ", "æµ·å¤–",
                ],
                "required": True,
            },
            {
                "id": 4,
                "title": "å¹´é½¢",
                "type": "TEXT",
                "required": True,
            },
            {
                "id": 5,
                "title": "ç¾åœ¨ã®å°±æ¥­å½¢æ…‹",
                "type": "RADIO",
                "options": [
                    "å°‚æ¥­ï¼ˆãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ãƒ»å€‹äººäº‹æ¥­ä¸»ï¼‰",
                    "å‰¯æ¥­ï¼ˆä¼šç¤¾å“¡ãƒ»å…¬å‹™å“¡ãªã©ï¼‰",
                    "å­¦ç”Ÿ",
                    "ãã®ä»–",
                ],
                "required": True,
            },
            {
                "id": 6,
                "title": "Discord ã§ã®ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ",
                "type": "TEXT",
                "helpText": "ã‚µãƒ¼ãƒãƒ¼å†…ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŠåå‰ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚",
                "required": True,
            },
        ],
    },
    {
        "header": "ãƒ“ã‚¸ãƒã‚¹ãƒ»äº‹æ¥­æ´»å‹•",
        "items": [
            {
                "id": 7,
                "title": "ã”è‡ªèº«ã§è¡Œã£ã¦ã„ã‚‹äº‹æ¥­ã®å†…å®¹",
                "type": "PARAGRAPH_TEXT",
                "helpText": "ï¼ˆä¾‹ï¼‰ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒ–ãƒ­ã‚°é‹å–¶ã€ECã‚µã‚¤ãƒˆã§ã®ç‰©è²©ã€SNSã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ãªã©ã€‚äº‹æ¥­ã‚’è¡Œã£ã¦ã„ãªã„å ´åˆã¯ã€Œãªã—ã€ã¨è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚",
                "required": False,
            },
            {
                "id": 8,
                "title": "ãã®äº‹æ¥­ã§ã®æœˆå•†è¦æ¨¡ï¼ˆæœ€é«˜æœˆåç›®å®‰ï¼‰",
                "type": "DROPDOWN",
                "options": [
                    "äº‹æ¥­ã¯ã—ã¦ã„ãªã„ / å£²ä¸Šãªã—",
                    "ã€œ5ä¸‡å††æœªæº€",
                    "5ä¸‡ ã€œ 20ä¸‡å††",
                    "20ä¸‡ ã€œ 50ä¸‡å††",
                    "50ä¸‡ ã€œ 100ä¸‡å††",
                    "100ä¸‡ ã€œ 300ä¸‡å††",
                    "300ä¸‡å††ä»¥ä¸Š",
                ],
                "required": True,
            },
            {
                "id": 9,
                "title": "ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ï¼ˆé©æ ¼è«‹æ±‚æ›¸ç™ºè¡Œäº‹æ¥­è€…ï¼‰ã¸ã®å¯¾å¿œ",
                "type": "RADIO",
                "options": [
                    "ç™»éŒ²æ¸ˆã¿ï¼ˆTç•ªå·ã‚ã‚Šï¼‰",
                    "ç™»éŒ²äºˆå®š / ç”³è«‹ä¸­",
                    "ç™»éŒ²ã—ã¦ã„ãªã„ï¼ˆå…ç¨äº‹æ¥­è€…ï¼‰",
                    "ã‚ã‹ã‚‰ãªã„",
                ],
                "required": True,
            },
        ],
    },
    {
        "header": "YouTubeæ´»å‹•å®Ÿç¸¾",
        "items": [
            {
                "id": 10,
                "title": "ã“ã‚Œã¾ã§ã®YouTubeé‹å–¶ãƒ»æ´»å‹•çµŒé¨“",
                "type": "RADIO",
                "options": ["ã‚ã‚Š", "ãªã—"],
                "required": True,
            },
            {
                "id": 11,
                "title": "YouTube æ´»å‹•æ­´ã®å¹´æ•°",
                "type": "TEXT",
                "helpText": "çµŒé¨“ãŒã‚ã‚‹å ´åˆã®ã¿è¨˜å…¥ï¼ˆä¾‹ï¼šç´„2å¹´ã€2020å¹´ã‹ã‚‰é–‹å§‹ãªã©ï¼‰",
                "required": False,
            },
            {
                "id": 12,
                "title": "ã”è‡ªèº«ã®ãƒãƒ£ãƒ³ãƒãƒ«ã®å®Ÿç¸¾ãƒ»ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª",
                "type": "PARAGRAPH_TEXT",
                "helpText": "URLã€ãƒãƒ£ãƒ³ãƒãƒ«åã€ç™»éŒ²è€…æ•°ã€æœ€é«˜å†ç”Ÿæ•°ãªã©ã€‚ã”è‡ªèº«ã®ãƒãƒ£ãƒ³ãƒãƒ«ã®å ´åˆã“ã¡ã‚‰ã«ã€‚",
                "required": False,
            },
            {
                "id": 13,
                "title": "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¯ãƒ¼ã‚¯ãƒ»ä»–äº‹æ¥­ã§ã®YouTubeå®Ÿç¸¾",
                "type": "PARAGRAPH_TEXT",
                "helpText": "ã”è‡ªèº«ã®ãƒãƒ£ãƒ³ãƒãƒ«ä»¥å¤–ã§æºã‚ã£ãŸæ¡ˆä»¶ã‚„ã€ãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚¹ã—ãŸãƒãƒ£ãƒ³ãƒãƒ«ã®å®Ÿç¸¾ãŒã‚ã‚Œã°ã”è¨˜å…¥ãã ã•ã„ã€‚",
                "required": False,
            },
        ],
    },
    {
        "header": "ã‚¹ã‚­ãƒ«ã‚»ãƒƒãƒˆãƒ»ä½¿ç”¨ãƒ„ãƒ¼ãƒ«",
        "items": [
            {
                "id": 14,
                "title": "ä½¿ç”¨çµŒé¨“ã®ã‚ã‚‹AIãƒ»ç”Ÿç”£æ€§å‘ä¸Šãƒ„ãƒ¼ãƒ«",
                "type": "CHECKBOX",
                "options": [
                    "ChatGPT",
                    "Claude",
                    "Gemini",
                    "Perplexity",
                    "Cursor (AIã‚¨ãƒ‡ã‚£ã‚¿)",
                    "GitHub Copilot",
                    "Midjourney / Stable Diffusion (ç”»åƒç”Ÿæˆ)",
                    "Vrew (AIå‹•ç”»ç·¨é›†)",
                    "Notion / Notion AI",
                    "Obsidian",
                ],
                "hasOtherOption": True,
                "required": True,
            },
            {
                "id": 15,
                "title": "YouTubeåˆ¶ä½œä»¥å¤–ã®ä¿æœ‰ã‚¹ã‚­ãƒ«",
                "type": "CHECKBOX",
                "options": [
                    "ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°ï¼ˆSEOãƒ»è¨˜äº‹ä½œæˆï¼‰",
                    "ã‚·ãƒŠãƒªã‚ªãƒ»å°æœ¬ä½œæˆ",
                    "ã‚µãƒ ãƒã‚¤ãƒ«ãƒ»ç”»åƒãƒ‡ã‚¶ã‚¤ãƒ³",
                    "Webãƒ‡ã‚¶ã‚¤ãƒ³ / LPåˆ¶ä½œ",
                    "åºƒå‘Šé‹ç”¨ï¼ˆGoogle / Meta / TikTokç­‰ï¼‰",
                    "SNSé‹ç”¨ä»£è¡Œï¼ˆX / Instagram / TikTokï¼‰",
                    "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ»é–‹ç™º",
                    "æ¥­å‹™è‡ªå‹•åŒ–ï¼ˆGAS / Make / Zapierç­‰ï¼‰",
                    "ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ",
                ],
                "hasOtherOption": True,
                "required": True,
            },
        ],
    },
    {
        "header": "ãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆãƒ»å¿—æœ›å‹•æ©Ÿãƒ»æ¡ä»¶",
        "items": [
            {
                "id": 16,
                "title": "MBTIï¼ˆ16ã‚¿ã‚¤ãƒ—æ€§æ ¼è¨ºæ–­ï¼‰",
                "type": "DROPDOWN",
                "helpText": "ä¸æ˜ãªå ´åˆã¯ã€Œä¸æ˜ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚",
                "options": [
                    "INTJï¼ˆå»ºç¯‰å®¶ï¼‰",
                    "INTPï¼ˆè«–ç†å­¦è€…ï¼‰",
                    "ENTJï¼ˆæŒ‡æ®å®˜ï¼‰",
                    "ENTPï¼ˆè¨è«–è€…ï¼‰",
                    "INFJï¼ˆæå”±è€…ï¼‰",
                    "INFPï¼ˆä»²ä»‹è€…ï¼‰",
                    "ENFJï¼ˆä¸»äººå…¬ï¼‰",
                    "ENFPï¼ˆé‹å‹•å®¶ï¼‰",
                    "ISTJï¼ˆç®¡ç†è€…ï¼‰",
                    "ISFJï¼ˆæ“è­·è€…ï¼‰",
                    "ESTJï¼ˆå¹¹éƒ¨ï¼‰",
                    "ESFJï¼ˆé ˜äº‹ï¼‰",
                    "ISTPï¼ˆå·¨åŒ ï¼‰",
                    "ISFPï¼ˆå†’é™ºå®¶ï¼‰",
                    "ESTPï¼ˆèµ·æ¥­å®¶ï¼‰",
                    "ESFPï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒŠãƒ¼ï¼‰",
                    "ä¸æ˜",
                ],
                "required": True,
            },
            {
                "id": 17,
                "title": "ãªãœäº•ä¸Šã•ã‚“ã®ã‚‚ã¨ã§åƒããŸã„ã¨æ€ã„ã¾ã—ãŸã‹ï¼Ÿï¼ˆå¿—æœ›å‹•æ©Ÿï¼‰",
                "type": "PARAGRAPH_TEXT",
                "required": True,
            },
            {
                "id": 18,
                "title": "ä»Šå¾Œã®ç›®æ¨™ï¼ˆã‚­ãƒ£ãƒªã‚¢ãƒ“ã‚¸ãƒ§ãƒ³ãªã©ï¼‰",
                "type": "PARAGRAPH_TEXT",
                "required": False,
            },
            {
                "id": 19,
                "title": "ä»Šå¾Œã®æ´»å‹•ã«å¯¾ã™ã‚‹æ„æ°—è¾¼ã¿",
                "type": "PARAGRAPH_TEXT",
                "required": False,
            },
            {
                "id": 20,
                "title": "é€±ã®ç¨¼åƒå¯èƒ½æ™‚é–“ï¼ˆç›®å®‰ï¼‰",
                "type": "TEXT",
                "helpText": "ï¼ˆä¾‹ï¼‰é€±10ã€œ15æ™‚é–“ç¨‹åº¦ã€å¹³æ—¥å¤œã¨åœŸæ—¥ä¸­å¿ƒ ãªã©",
                "required": True,
            },
            {
                "id": 21,
                "title": "ç¨¼åƒãŒé›£ã—ã„æ›œæ—¥ãƒ»æ™‚é–“å¸¯ / é€£çµ¡ãŒå–ã‚Šã¥ã‚‰ã„æ™‚é–“å¸¯",
                "type": "TEXT",
                "helpText": "ï¼ˆä¾‹ï¼‰æ°´æ›œæ—¥ã¯ä¸å¯ã€å¹³æ—¥ã®9:00ã€œ18:00ã¯æœ¬æ¥­ã®ãŸã‚é€£çµ¡ä¸å¯ã€æ·±å¤œ24æ™‚ä»¥é™ ãªã©",
                "required": False,
            },
        ],
    },
]


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# èªè¨¼
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def print_banner():
    """ãƒãƒŠãƒ¼è¡¨ç¤º"""
    print("=" * 80)
    print("ã€æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•å‚åŠ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã€‘Google ãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•ä½œæˆãƒ„ãƒ¼ãƒ«")
    print("=" * 80)
    print()


def check_credentials():
    """èªè¨¼æƒ…å ±ã‚’ãƒã‚§ãƒƒã‚¯"""
    if os.path.exists(CREDENTIALS_FILE):
        print("âœ“ èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ")
        return True

    print("âŒ èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
    print(f"ãƒ‘ã‚¹: {CREDENTIALS_FILE}")
    return False


def authenticate():
    """Google API ã®èªè¨¼"""
    creds = None

    # æ—¢å­˜ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç¢ºèª
    if os.path.exists(TOKEN_FILE):
        print("âœ“ æ—¢å­˜ã®èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’èª­ã¿è¾¼ã¿ä¸­...")
        with open(TOKEN_FILE, 'rb') as token:
            creds = pickle.load(token)

    # ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã¾ãŸã¯å­˜åœ¨ã—ãªã„å ´åˆ
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            print("âœ“ èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ›´æ–°ä¸­...")
            creds.refresh(Request())
        else:
            if not os.path.exists(CREDENTIALS_FILE):
                return None

            print()
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("ğŸ” Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã®èªè¨¼ãŒå¿…è¦ã§ã™")
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print()
            print("ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§é–‹ãã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ï¼š")
            print()
            print("1. Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠ")
            print("2. ã€Œã“ã®ã‚¢ãƒ—ãƒªã¯ç¢ºèªã•ã‚Œã¦ã„ã¾ã›ã‚“ã€ã¨è¡¨ç¤ºã•ã‚ŒãŸã‚‰")
            print("   â†’ã€Œè©³ç´°ã€â†’ã€Œï¼ˆå®‰å…¨ã§ãªã„ãƒšãƒ¼ã‚¸ã«ç§»å‹•ï¼‰ã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
            print("3. ã€Œè¨±å¯ã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
            print()
            print("ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ã„ã¦ã„ã¾ã™...")
            print()

            flow = InstalledAppFlow.from_client_secrets_file(
                CREDENTIALS_FILE, SCOPES)
            creds = flow.run_local_server(
                port=0,
                open_browser=True,
                authorization_prompt_message='',
                success_message='èªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸï¼ã“ã®ã‚¿ãƒ–ã‚’é–‰ã˜ã¦ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«æˆ»ã£ã¦ãã ã•ã„ã€‚',
            )

        # ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
        print("âœ“ èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜ä¸­...")
        with open(TOKEN_FILE, 'wb') as token:
            pickle.dump(creds, token)

    return creds


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã‚¢ã‚¤ãƒ†ãƒ å¤‰æ›ãƒ˜ãƒ«ãƒ‘ãƒ¼
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def build_question_item(item):
    """
    JSON ã‚¢ã‚¤ãƒ†ãƒ å®šç¾© â†’ Google Forms API ã® createItem ãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨è¾æ›¸ã«å¤‰æ›

    å¯¾å¿œã‚¿ã‚¤ãƒ—:
      TEXT / PARAGRAPH_TEXT â†’ textQuestion
      RADIO              â†’ choiceQuestion (RADIO)
      CHECKBOX           â†’ choiceQuestion (CHECKBOX)
      DROPDOWN           â†’ choiceQuestion (DROP_DOWN)
    """
    q_type = item["type"]
    required = item.get("required", False)

    # â”€â”€ ãƒ†ã‚­ã‚¹ãƒˆç³» â”€â”€
    if q_type in ("TEXT", "PARAGRAPH_TEXT"):
        question = {
            "required": required,
            "textQuestion": {
                "paragraph": q_type == "PARAGRAPH_TEXT"
            }
        }
        return question

    # â”€â”€ é¸æŠè‚¢ç³» (RADIO / CHECKBOX / DROPDOWN) â”€â”€
    type_map = {
        "RADIO": "RADIO",
        "CHECKBOX": "CHECKBOX",
        "DROPDOWN": "DROP_DOWN",
    }
    if q_type in type_map:
        options = [{"value": opt} for opt in item.get("options", [])]

        # ã€Œãã®ä»–ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³
        if item.get("hasOtherOption"):
            options.append({"isOther": True})

        question = {
            "required": required,
            "choiceQuestion": {
                "type": type_map[q_type],
                "options": options,
            }
        }
        return question

    # â”€â”€ æœªå¯¾å¿œã‚¿ã‚¤ãƒ— â”€â”€
    print(f"  âš  æœªå¯¾å¿œã®ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—: {q_type} (id={item.get('id')})")
    return None


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆãƒ¡ã‚¤ãƒ³
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def create_form(service):
    """Google ãƒ•ã‚©ãƒ¼ãƒ ã‚’è‡ªå‹•ä½œæˆã™ã‚‹"""

    print()
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    print("ğŸ“ ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆä¸­...")
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    print()

    try:
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # Step 1: ãƒ•ã‚©ãƒ¼ãƒ æœ¬ä½“ã‚’ä½œæˆ
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        print("  [1/4] ãƒ•ã‚©ãƒ¼ãƒ ã®åŸºæœ¬æƒ…å ±ã‚’è¨­å®šä¸­...")
        form = {"info": {"title": FORM_TITLE}}
        result = service.forms().create(body=form).execute()
        form_id = result.get('formId')
        print(f"  âœ“ ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã—ãŸï¼ˆID: {form_id}ï¼‰")

        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # Step 2: èª¬æ˜æ–‡ã‚’è¿½åŠ 
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        print("  âœ“ ãƒ•ã‚©ãƒ¼ãƒ ã®èª¬æ˜æ–‡ã‚’è¿½åŠ ä¸­...")
        desc_body = {
            "requests": [{
                "updateFormInfo": {
                    "info": {"description": FORM_DESCRIPTION},
                    "updateMask": "description"
                }
            }]
        }
        service.forms().batchUpdate(formId=form_id, body=desc_body).execute()
        print("  âœ“ èª¬æ˜æ–‡ã‚’è¿½åŠ ã—ã¾ã—ãŸ")

        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # Step 3: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ + è³ªå•ã‚’æ§‹ç¯‰
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        total_questions = sum(len(s["items"]) for s in SECTIONS)
        print(f"  [2/4] è³ªå•é …ç›®ã‚’è¿½åŠ ä¸­ï¼ˆå…¨{total_questions}å•ãƒ»{len(SECTIONS)}ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰...")

        requests = []
        index = 0  # ãƒ•ã‚©ãƒ¼ãƒ å†…ã§ã®ã‚¢ã‚¤ãƒ†ãƒ ä½ç½®

        for section in SECTIONS:
            # â”€â”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒ†ã‚­ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ï¼‰ â”€â”€
            requests.append({
                "createItem": {
                    "item": {
                        "title": section["header"],
                        "textItem": {}
                    },
                    "location": {"index": index}
                }
            })
            index += 1

            # â”€â”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®è³ªå• â”€â”€
            for item in section["items"]:
                question = build_question_item(item)
                if question is None:
                    continue

                form_item = {
                    "title": item["title"],
                    "questionItem": {
                        "question": question
                    }
                }

                # ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆï¼ˆèª¬æ˜æ–‡ï¼‰
                if item.get("helpText"):
                    form_item["description"] = item["helpText"]

                requests.append({
                    "createItem": {
                        "item": form_item,
                        "location": {"index": index}
                    }
                })
                index += 1

        print(f"  âœ“ {index}å€‹ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’æº–å‚™ã—ã¾ã—ãŸ")

        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # Step 4: ä¸€æ‹¬è¿½åŠ 
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        print("  [3/4] ãƒ•ã‚©ãƒ¼ãƒ ã«è³ªå•ã‚’è¿½åŠ ä¸­...")
        body = {"requests": requests}
        service.forms().batchUpdate(formId=form_id, body=body).execute()
        print("  âœ“ ã™ã¹ã¦ã®è³ªå•é …ç›®ã‚’è¿½åŠ ã—ã¾ã—ãŸ")

        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # Step 5: ãƒ•ã‚©ãƒ¼ãƒ è¨­å®š
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        print("  [4/4] ãƒ•ã‚©ãƒ¼ãƒ è¨­å®šã‚’æœ€é©åŒ–ä¸­...")
        settings_body = {
            "requests": [{
                "updateSettings": {
                    "settings": {
                        "quizSettings": {"isQuiz": False}
                    },
                    "updateMask": "quizSettings.isQuiz"
                }
            }]
        }
        service.forms().batchUpdate(formId=form_id, body=settings_body).execute()
        print("  âœ“ ãƒ•ã‚©ãƒ¼ãƒ è¨­å®šã‚’å®Œäº†ã—ã¾ã—ãŸ")

        return form_id

    except HttpError as error:
        print(f"\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {error}")
        return None


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# çµæœä¿å­˜
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def save_form_info(form_id):
    """ãƒ•ã‚©ãƒ¼ãƒ æƒ…å ±ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜"""
    edit_url = f"https://docs.google.com/forms/d/{form_id}/edit"
    view_url = f"https://docs.google.com/forms/d/{form_id}/viewform"

    info_file = Path(r"C:\Cursor\youtube-mania\æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•å‚åŠ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ_æƒ…å ±.txt")
    with open(info_file, 'w', encoding='utf-8') as f:
        f.write("=" * 80 + "\n")
        f.write("æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•å‚åŠ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ - å®Œæˆæƒ…å ±\n")
        f.write("=" * 80 + "\n\n")
        f.write(f"ãƒ•ã‚©ãƒ¼ãƒ ID: {form_id}\n\n")
        f.write("ã€ç·¨é›†ç”¨URLã€‘\n")
        f.write(f"{edit_url}\n\n")
        f.write("ã€å›ç­”ç”¨URLã€‘ï¼ˆã‚¹ã‚¿ãƒƒãƒ•ã«å…±æœ‰ï¼‰\n")
        f.write(f"{view_url}\n\n")
        f.write("=" * 80 + "\n")
        f.write("ãƒ•ã‚©ãƒ¼ãƒ æƒ…å ±\n")
        f.write("=" * 80 + "\n\n")
        f.write("è³ªå•æ•°ï¼šå…¨21å•\n")
        f.write("ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ•°ï¼š5\n")
        f.write("  1. åŸºæœ¬æƒ…å ±ãƒ»å±æ€§ï¼ˆ6å•ï¼‰\n")
        f.write("  2. ãƒ“ã‚¸ãƒã‚¹ãƒ»äº‹æ¥­æ´»å‹•ï¼ˆ3å•ï¼‰\n")
        f.write("  3. YouTubeæ´»å‹•å®Ÿç¸¾ï¼ˆ4å•ï¼‰\n")
        f.write("  4. ã‚¹ã‚­ãƒ«ã‚»ãƒƒãƒˆãƒ»ä½¿ç”¨ãƒ„ãƒ¼ãƒ«ï¼ˆ2å•ï¼‰\n")
        f.write("  5. ãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆãƒ»å¿—æœ›å‹•æ©Ÿãƒ»æ¡ä»¶ï¼ˆ6å•ï¼‰\n\n")
        f.write("=" * 80 + "\n")
        f.write("æ¨å¥¨è¨­å®šï¼ˆæ‰‹å‹•ã§ç¢ºèªã—ã¦ãã ã•ã„ï¼‰\n")
        f.write("=" * 80 + "\n\n")
        f.write("ãƒ•ã‚©ãƒ¼ãƒ ã®ç·¨é›†ç”»é¢ã§ã€Œè¨­å®šã€ï¼ˆâš™ï¸ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã‚’è¨­å®šï¼š\n\n")
        f.write("1. ã€Œå…¨èˆ¬ã€ã‚¿ãƒ–:\n")
        f.write("   - [ ] ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åé›†ã™ã‚‹ â†’ OFFï¼ˆè³ªå•å†…ã§åé›†æ¸ˆã¿ï¼‰\n\n")
        f.write("2. ã€Œãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¿ãƒ–:\n")
        f.write("   ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ä»¥ä¸‹ã‚’å…¥åŠ›:\n\n")
        f.write("   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n")
        f.write("   ã”å›ç­”ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼\n\n")
        f.write("   ã”å…¥åŠ›ã„ãŸã ã„ãŸæƒ…å ±ã‚’ç¢ºèªã®ä¸Šã€\n")
        f.write("   é †æ¬¡ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\n")
        f.write("   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n")
        f.write("3. ã€Œä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯\n\n")
        f.write("=" * 80 + "\n")
        f.write("\nâ€» ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å…¥åŠ›è¦å‰‡ï¼ˆEMAIL ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã¯\n")
        f.write("  Google Forms API v1 ã§ã¯ç›´æ¥è¨­å®šã§ãã¾ã›ã‚“ã€‚\n")
        f.write("  å¿…è¦ã«å¿œã˜ã¦ãƒ•ã‚©ãƒ¼ãƒ ç·¨é›†ç”»é¢ã‹ã‚‰æ‰‹å‹•ã§è¨­å®šã—ã¦ãã ã•ã„ã€‚\n")
        f.write("  ï¼ˆQ2ã€Œãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆGmailï¼‰ã€â†’ å›ç­”ã®æ¤œè¨¼ â†’ ãƒ†ã‚­ã‚¹ãƒˆ â†’ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰\n")

    return edit_url, view_url, info_file


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def main():
    """ãƒ¡ã‚¤ãƒ³å‡¦ç†"""
    print_banner()

    # èªè¨¼æƒ…å ±ãƒã‚§ãƒƒã‚¯
    if not check_credentials():
        return

    print()

    # èªè¨¼
    print("ğŸ” èªè¨¼ã‚’ç¢ºèªä¸­...")
    creds = authenticate()
    if not creds:
        print("\nâŒ èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ")
        print("credentials.json ã‚’ç¢ºèªã—ã¦ãã ã•ã„")
        return

    print("âœ“ èªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸ")

    # Google Forms API ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ§‹ç¯‰
    try:
        print("âœ“ Google Forms API ã«æ¥ç¶šä¸­...")
        service = build('forms', 'v1', credentials=creds)

        # ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
        form_id = create_form(service)

        if form_id:
            edit_url, view_url, info_file = save_form_info(form_id)

            print()
            print("=" * 80)
            print("ğŸ‰ ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼")
            print("=" * 80)
            print()
            print("ğŸ“ ãƒ•ã‚©ãƒ¼ãƒ æƒ…å ±:")
            print(f"   ç·¨é›†URL: {edit_url}")
            print(f"   å›ç­”URL: {view_url}")
            print()
            print(f"âœ“ è©³ç´°æƒ…å ±ã‚’ä¿å­˜ã—ã¾ã—ãŸ: {info_file}")
            print()
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("âš ï¸ æ‰‹å‹•ç¢ºèªäº‹é …")
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print()
            print("  1. Q2ã€Œãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã«ãƒ¡ãƒ¼ãƒ«å½¢å¼ã®å…¥åŠ›è¦å‰‡ã‚’è¨­å®š")
            print("     â†’ å›ç­”ã®æ¤œè¨¼ â†’ ãƒ†ã‚­ã‚¹ãƒˆ â†’ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹")
            print("  2. ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¨­å®š")
            print()
            print(f"  è©³ç´°ã¯ã€Œ{info_file}ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚")
            print()

            print("ãƒ–ãƒ©ã‚¦ã‚¶ã§ç·¨é›†ç”»é¢ã‚’é–‹ã„ã¦ã„ã¾ã™...")
            webbrowser.open(edit_url)

            print()
            print("=" * 80)
            print("âœ¨ ã™ã¹ã¦ã®ä½œæ¥­ãŒå®Œäº†ã—ã¾ã—ãŸï¼")
            print("=" * 80)
        else:
            print("\nâŒ ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")

    except HttpError as error:
        print(f"\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {error}")
        import traceback
        traceback.print_exc()


if __name__ == '__main__':
    try:
        main()
    except KeyboardInterrupt:
        print("\n\nå‡¦ç†ãŒä¸­æ–­ã•ã‚Œã¾ã—ãŸ")
    except Exception as e:
        print(f"\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        import traceback
        traceback.print_exc()
